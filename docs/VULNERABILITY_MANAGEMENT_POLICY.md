# Evidify Vulnerability Management Policy

**Version:** 1.0  
**Effective Date:** January 2026  
**Owner:** Security Team  
**Review Cycle:** Quarterly

---

## 1. Purpose

This policy establishes the framework for identifying, assessing, prioritizing, and remediating security vulnerabilities in the Evidify application, its dependencies, and supporting infrastructure.

## 2. Scope

This policy applies to:

- Evidify application source code (Rust backend, TypeScript frontend)
- Third-party dependencies (Cargo crates, npm packages)
- System dependencies (SQLCipher, Ollama, whisper.cpp)
- Build and release infrastructure
- Development and testing environments

## 3. Vulnerability Sources

### 3.1 Automated Discovery

| Source | Frequency | Tool |
|--------|-----------|------|
| Rust dependencies | Daily + PR | `cargo audit` |
| Node.js dependencies | Daily + PR | `npm audit` |
| Static analysis | Weekly | `cargo clippy`, `eslint` |
| Container scanning | Per build | Trivy (if applicable) |

### 3.2 Manual Discovery

| Source | Process |
|--------|---------|
| Security researchers | security@evidify.ai |
| Internal code review | Pull request process |
| Penetration testing | Annual + major releases |
| Customer reports | Support escalation |

## 4. Severity Classification

Based on CVSS v3.1 scores and contextual factors:

| Severity | CVSS Score | PHI Impact | Response SLA | Examples |
|----------|------------|------------|--------------|----------|
| **Critical** | 9.0-10.0 | Direct PHI exposure possible | 24 hours | RCE, auth bypass, SQLi with vault access |
| **High** | 7.0-8.9 | Indirect PHI exposure or significant risk | 7 days | Privilege escalation, XSS with session hijack |
| **Medium** | 4.0-6.9 | Limited impact, defense in depth | 30 days | Information disclosure, DoS |
| **Low** | 0.1-3.9 | Minimal impact | 90 days | Minor information leak, hardening gaps |

### 4.1 Contextual Adjustments

| Factor | Adjustment |
|--------|------------|
| Actively exploited in the wild | +1 severity level |
| Requires physical access | -1 severity level |
| Requires local-only network | -1 severity level |
| Affects PHI-handling code paths | +1 severity level |
| Mitigated by existing controls | -1 severity level |

## 5. Vulnerability Lifecycle

### 5.1 Intake

```
Discovery → Triage → Classification → Assignment → Tracking
```

1. **Discovery**: Vulnerability identified via automated scan or manual report
2. **Triage**: Security team reviews within 24 hours
3. **Classification**: Assign severity using CVSS + contextual factors
4. **Assignment**: Route to appropriate engineering team
5. **Tracking**: Create tracking issue with SLA deadline

### 5.2 Assessment

For each vulnerability, document:

- [ ] CVE/advisory reference (if available)
- [ ] Affected component(s) and version(s)
- [ ] Attack vector and prerequisites
- [ ] Potential impact on PHI/clinical safety
- [ ] Exploitability in Evidify context
- [ ] Existing mitigating controls
- [ ] Recommended remediation

### 5.3 Remediation Options

| Priority | Option | When to Use |
|----------|--------|-------------|
| 1 | Upgrade dependency | Patch available, no breaking changes |
| 2 | Apply workaround | Patch not yet available |
| 3 | Implement compensating control | Cannot upgrade immediately |
| 4 | Accept risk | Impact minimal after context analysis |

### 5.4 Risk Acceptance

Risk acceptance requires:

- Written justification
- Compensating controls documented
- Security Officer approval
- Quarterly review until resolved
- Customer notification if Critical/High

## 6. Response Procedures

### 6.1 Critical Vulnerabilities (24-hour SLA)

1. **Hour 0-2**: Triage and confirm severity
2. **Hour 2-4**: Identify remediation path
3. **Hour 4-12**: Develop and test fix
4. **Hour 12-20**: Internal QA and security review
5. **Hour 20-24**: Release patch or mitigation guidance
6. **Post-release**: Customer communication within 24 hours

### 6.2 High Vulnerabilities (7-day SLA)

1. **Day 1**: Triage, classify, assign
2. **Day 2-4**: Develop fix
3. **Day 5-6**: Testing and review
4. **Day 7**: Release in next scheduled update

### 6.3 Medium/Low Vulnerabilities

- Bundle with regular release cycles
- Track in backlog with appropriate priority

## 7. Disclosure Policy

### 7.1 Vulnerabilities in Evidify

| Timeline | Action |
|----------|--------|
| Day 0 | Vulnerability confirmed |
| Day 1-7 | Fix developed and tested |
| Day 7-14 | Patch released |
| Day 14+ | Public advisory (if needed) |

### 7.2 Vulnerabilities in Dependencies

- Coordinate with upstream maintainers
- Follow responsible disclosure timelines
- Document mitigations while waiting for upstream fix

### 7.3 Customer Notification

| Severity | Notification |
|----------|--------------|
| Critical | Within 24 hours of patch availability |
| High | Within 7 days of patch availability |
| Medium/Low | Release notes only |

## 8. Metrics and Reporting

### 8.1 Key Metrics

| Metric | Target | Measurement |
|--------|--------|-------------|
| Mean Time to Detect (MTTD) | < 24 hours | Discovery date - public disclosure date |
| Mean Time to Remediate (MTTR) | Per severity SLA | Resolution date - discovery date |
| Vulnerability Backlog Age | 0 critical, < 5 high | Current count by severity |
| Scan Coverage | 100% | % of codebase scanned |

### 8.2 Reporting

| Report | Frequency | Audience |
|--------|-----------|----------|
| Vulnerability summary | Weekly | Engineering leads |
| Security metrics | Monthly | Leadership |
| Compliance report | Quarterly | GRC/Auditors |
| SBOM update | Per release | Customers (on request) |

## 9. Dependency Management

### 9.1 Approved Sources

| Ecosystem | Source | Verification |
|-----------|--------|--------------|
| Rust | crates.io | Checksum + advisory DB |
| Node.js | npmjs.com | Checksum + advisory DB |
| System | Official vendor | GPG signature |

### 9.2 Dependency Hygiene

- Review new dependencies before adoption
- Prefer dependencies with active maintenance
- Limit transitive dependency depth where possible
- Pin versions in lock files
- Update dependencies monthly (at minimum)

### 9.3 Banned Patterns

Do not introduce dependencies that:
- Require network access for core functionality
- Have unreviewed/unclear licenses
- Are unmaintained (> 2 years without update)
- Have known unpatched Critical/High vulnerabilities

## 10. Roles and Responsibilities

| Role | Responsibilities |
|------|------------------|
| **Security Team** | Policy ownership, triage, classification, metrics |
| **Engineering** | Remediation, testing, release |
| **Product** | Customer communication, release planning |
| **Leadership** | Risk acceptance approval, resource allocation |

## 11. Tools and Resources

### 11.1 Scanning Tools

```bash
# Daily Rust audit
cd src-tauri && cargo audit

# Daily Node audit
cd frontend && npm audit

# Weekly Clippy (static analysis)
cd src-tauri && cargo clippy -- -D warnings
```

### 11.2 Advisory Databases

- [RustSec Advisory Database](https://rustsec.org/)
- [npm Security Advisories](https://www.npmjs.com/advisories)
- [NVD (National Vulnerability Database)](https://nvd.nist.gov/)
- [GitHub Security Advisories](https://github.com/advisories)

### 11.3 Internal Resources

- Vulnerability tracking: [Issue tracker]
- Security contacts: security@evidify.ai
- Incident response: See Incident Response Plan

## 12. Exceptions

Exceptions to this policy require:

1. Written request with justification
2. Risk assessment
3. Security Officer approval
4. Documented compensating controls
5. Expiration date (maximum 90 days)
6. Quarterly review

## 13. Policy Maintenance

| Activity | Frequency |
|----------|-----------|
| Policy review | Quarterly |
| Tool evaluation | Annually |
| Metrics review | Monthly |
| Training | Annually + new hires |

---

## Appendix A: Vulnerability Report Template

```markdown
## Vulnerability Report

**ID:** EVID-YYYY-NNNN
**Date Discovered:** YYYY-MM-DD
**Reporter:** [Name/Source]
**Severity:** [Critical/High/Medium/Low]
**CVSS Score:** X.X
**Status:** [New/Triaging/In Progress/Resolved/Accepted]

### Summary
[Brief description of the vulnerability]

### Affected Components
- Component: [name]
- Versions: [affected versions]
- File(s): [specific files if known]

### Technical Details
[Detailed technical description]

### Impact Assessment
- PHI Impact: [Yes/No - explain]
- Clinical Safety: [Yes/No - explain]
- Attack Prerequisites: [list]

### Remediation
- Recommended Fix: [description]
- Workaround: [if available]
- Target Release: [version]

### Timeline
- Discovered: YYYY-MM-DD
- Triaged: YYYY-MM-DD
- Fixed: YYYY-MM-DD
- Released: YYYY-MM-DD

### References
- CVE: [if assigned]
- Advisory: [link]
- Related Issues: [links]
```

## Appendix B: Security Scanning CI Configuration

See `.github/workflows/security.yml` for automated scanning configuration.

---

**Document History**

| Version | Date | Author | Changes |
|---------|------|--------|---------|
| 1.0 | Jan 2026 | Security Team | Initial release |

---

*This policy is reviewed quarterly and updated as needed to reflect evolving threats and best practices.*
